summarise(사고건수_평균 = mean(사고건수))
View(dura_sunshine_group)
shine <- shinedata %>%
group_by(발생일) %>%
summarise(일조시간 = max(합계.일조시간.hr.))
acci_sum <- shinedata %>%
group_by(발생일) %>%
summarise(사고건수 = sum(사고건수))
View(acci_sum)
data_shine <- merge(shine,acci_sum, by="발생일", all=T)
View(data_shine)
is.na(data_shine)
write.csv(data_shine,file="data_shine.csv")
dura_sunshine_group <- dura_sunshine %>%
group_by(data_shine) %>%
summarise(사고건수_평균 = mean(사고건수))
View(dura_sunshine_group)
summary(dura_sunshine)
dura_sunshine$일조시간<- na.omit(dura_sunshine$일조시간)
dura_sunshine <- na.omit(dura_sunshine)
View(dura_sunshine)
summary(dura_sunshine)
summary(data_shine)
data_shine <- na.omit(data_shine)
View(data_shine)
summary(data_shine)
dura_sunshine$그룹 <- ifelse(dura_sunshin$일조시간 <= 3,'0~3'&
ifelse(dura_sunshin$일조시간 <= 6, '4~6'&
ifelse(dura_sunshin$일조시간 <= 9, '7~9'&'10이상')))
dura_sunshine$그룹 <- ifelse(data_shine$일조시간 <= 3,'0~3'&
ifelse(data_shine$일조시간 <= 6, '4~6'&
ifelse(data_shine$일조시간 <= 9, '7~9'&'10이상')))
dura_sunshine$그룹 <- ifelse(data_shine$일조시간 <= 3,'0~3'&
ifelse(data_shine$일조시간 <= 6, '4~6'&
ifelse(data_shine$일조시간 <= 9, '7~9','10이상')))
dura_sunshine$그룹 <- ifelse(data_shine$일조시간 <= 3,'0~3',
ifelse(data_shine$일조시간 <= 6, '4~6',
ifelse(data_shine$일조시간 <= 9, '7~9','10이상')))
View(dura_sunshine_group)
dura_sunshine_group <- dura_sunshine %>%
group_by(data_shine) %>%
summarise(사고건수_평균 = mean(사고건수))
dura_sunshine_group <- data_shine %>%
group_by(data_shine) %>%
summarise(사고건수_평균 = mean(사고건수))
View(dura_sunshine_group)
summary(data_shine)
data_shine <- na.omit(data_shine)
dura_sunshine_group <- data_shine %>%
group_by(data_shine) %>%
summarise(사고건수_평균 = mean(사고건수))
View(dura_sunshine_group)
dura_sunshine_group <- data_shine %>%
group_by(data_shine) %>%
summarise(사고건수_평균 = mean(사고건수))
View(data_shine)
dura_sunshine_group <- data_shine %>%
group_by(발생일) %>%
summarise(사고건수_평균 = mean(사고건수))
View(dura_sunshine_group)
data_shine$group <- ifelse(data_shine$일조시간 <= 3,'0~3',
ifelse(data_shine$일조시간 <= 6, '4~6',
ifelse(data_shine$일조시간 <= 9, '7~9','10이상')))
dura_sunshine_group <- data_shine %>%
group_by(group) %>%
summarise(사고건수_평균 = sum(사고건수))
View(dura_sunshine_group)
dura_sunshine_group <- data_shine %>%
group_by(group) %>%
summarise(사고건수_평균 = mean(사고건수))
View(dura_sunshine_group)
dura_sunshine_group$group <- factor(dura_sunshine_group$group,levels=c('0~3', '4~6','7~9', '10이상'))
View(dura_sunshine_group)
class(dura_sunshine_group)
ggplot(dura_sunshine_group, aes(x=group, y=사고건수_평균))+
geom_point(aes(color=dura_sunshine_group))+
theme(axis.line.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()) +
theme(legend.position = "bottom")
ggplot(dura_sunshine_group, aes(x=group, y=사고건수_평균))+
geom_point(aes(color="blue"))+
theme(axis.line.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()) +
theme(legend.position = "bottom")
ggplot(dura_sunshine_group, aes(x=group, y=사고건수_평균))+
geom_line(aes(color="blue"))+
theme(axis.line.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()) +
theme(legend.position = "bottom")
ggplot(dura_sunshine_group, aes(x=group, y=사고건수_평균,group=1
))+
geom_line(aes(color="blue"))+
theme(axis.line.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()) +
theme(legend.position = "bottom")
data_shine$group <- ifelse(data_shine$일조시간 <= 1,'1',
ifelse(data_shine$일조시간 <= 2,'2',
ifelse(data_shine$일조시간 <= 3,'3',
ifelse(data_shine$일조시간 <= 4,'4',
ifelse(data_shine$일조시간 <= 5,'5',
ifelse(data_shine$일조시간 <= 6,'6',
ifelse(data_shine$일조시간 <= 7,'7',
ifelse(data_shine$일조시간 <= 8,'8',
ifelse(data_shine$일조시간 <= 9,'9',
ifelse(data_shine$일조시간 <= 10,'10',
ifelse(data_shine$일조시간 <= 11,'11',
ifelse(data_shine$일조시간 <= 12,'12','13이상'))))))))))))
dura_sunshine_group <- data_shine %>%
group_by(group) %>%
summarise(사고건수_평균 = mean(사고건수))
View(dura_sunshine_group)
dura_sunshine_group$group <- factor(dura_sunshine_group$group,levels=c('0~3', '4~6','7~9', '10이상'))
View(dura_sunshine_group)
dura_sunshine_group$group <- factor(dura_sunshine_group$group,levels=c('1','2','3','4','5','6','7','8','9','10','11','12','13'))
View(dura_sunshine_group)
data_shine$group <- ifelse(data_shine$일조시간 <= 1,'1',
ifelse(data_shine$일조시간 <= 2,'2',
ifelse(data_shine$일조시간 <= 3,'3',
ifelse(data_shine$일조시간 <= 4,'4',
ifelse(data_shine$일조시간 <= 5,'5',
ifelse(data_shine$일조시간 <= 6,'6',
ifelse(data_shine$일조시간 <= 7,'7',
ifelse(data_shine$일조시간 <= 8,'8',
ifelse(data_shine$일조시간 <= 9,'9',
ifelse(data_shine$일조시간 <= 10,'10',
ifelse(data_shine$일조시간 <= 11,'11',
ifelse(data_shine$일조시간 <= 12,'12','13이상'))))))))))))
dura_sunshine_group <- data_shine %>%
group_by(group) %>%
summarise(사고건수_평균 = mean(사고건수))
dura_sunshine_group$group <- factor(dura_sunshine_group$group,levels=c('1','2','3','4','5','6','7','8','9','10','11','12','13'))
View(dura_sunshine_group)
data_shine$group <- ifelse(data_shine$일조시간 <= 1,'1',
ifelse(data_shine$일조시간 <= 2,'2',
ifelse(data_shine$일조시간 <= 3,'3',
ifelse(data_shine$일조시간 <= 4,'4',
ifelse(data_shine$일조시간 <= 5,'5',
ifelse(data_shine$일조시간 <= 6,'6',
ifelse(data_shine$일조시간 <= 7,'7',
ifelse(data_shine$일조시간 <= 8,'8',
ifelse(data_shine$일조시간 <= 9,'9',
ifelse(data_shine$일조시간 <= 10,'10',
ifelse(data_shine$일조시간 <= 11,'11',
ifelse(data_shine$일조시간 <= 12,'12',
ifelse(data_shine$일조시간 <= 13,'13','14이상')))))))))))))
dura_sunshine_group <- data_shine %>%
group_by(group) %>%
summarise(사고건수_평균 = mean(사고건수))
dura_sunshine_group$group <- factor(dura_sunshine_group$group,levels=c('1','2','3','4','5','6','7','8','9','10','11','12','13','14'))
View(dura_sunshine_group)
summary(dura_sunshine_group)
data_shine$group <- ifelse(data_shine$일조시간 <= 1,'1',
ifelse(data_shine$일조시간 <= 2,'2',
ifelse(data_shine$일조시간 <= 3,'3',
ifelse(data_shine$일조시간 <= 4,'4',
ifelse(data_shine$일조시간 <= 5,'5',
ifelse(data_shine$일조시간 <= 6,'6',
ifelse(data_shine$일조시간 <= 7,'7',
ifelse(data_shine$일조시간 <= 8,'8',
ifelse(data_shine$일조시간 <= 9,'9',
ifelse(data_shine$일조시간 <= 10,'10',
ifelse(data_shine$일조시간 <= 11,'11',
ifelse(data_shine$일조시간 <= 12,'12',
ifelse(data_shine$일조시간 <= 13,'13','14이상')))))))))))))
dura_sunshine_group <- data_shine %>%
group_by(group) %>%
summarise(사고건수_평균 = mean(사고건수))
summary(dura_sunshine_group)
dura_sunshine_group$group <- factor(dura_sunshine_group$group,levels=c('1','2','3','4','5','6','7','8','9','10','11','12','13','14'))
View(dura_sunshine_group)
data_shine$group <- ifelse(data_shine$일조시간 <= 1,'1',
ifelse(data_shine$일조시간 <= 2,'2',
ifelse(data_shine$일조시간 <= 3,'3',
ifelse(data_shine$일조시간 <= 4,'4',
ifelse(data_shine$일조시간 <= 5,'5',
ifelse(data_shine$일조시간 <= 6,'6',
ifelse(data_shine$일조시간 <= 7,'7',
ifelse(data_shine$일조시간 <= 8,'8',
ifelse(data_shine$일조시간 <= 9,'9',
ifelse(data_shine$일조시간 <= 10,'10',
ifelse(data_shine$일조시간 <= 11,'11',
ifelse(data_shine$일조시간 <= 12,'12',
ifelse(data_shine$일조시간 <= 13,'13','14이상')))))))))))))
dura_sunshine_group <- data_shine %>%
group_by(group) %>%
summarise(사고건수_평균 = mean(사고건수))
summary(dura_sunshine_group)
dura_sunshine_group$group <- factor(dura_sunshine_group$group,levels=c('1','2','3','4','5','6','7','8','9','10','11','12','13','14이상'))
View(dura_sunshine_group)
ggplot(dura_sunshine_group, aes(x=group, y=사고건수_평균,group=1
))+
geom_line(aes(color="blue"))+
theme(axis.line.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()) +
theme(legend.position = "bottom")
ggplot(dura_sunshine_group,aes(x=group,y=사고건수사고건수_평균,group=1
))+
+ ylim(30,200)
+ geom_line()
+ ggtitle("17~19년도 일조량에 따른 사고건수")
View(shinedata)
crash <- read.csv("도로교통공단_서울시 일별 시간별 교통사고 현황_20191231.csv")
str(crash)
View(crash)
ls(crash)
gu_data <- select(crash,"발생일","발생지_시군구", "사고건수)
head(gu_data)
View(gu_data)
gu_data <- select(crash,"발생일","발생지_시군구", "사고건수)
#######################################
# 계절별 시간별 구별 연도별 사고건수
#   x축 연도, y축 : 사고건수
######################################
# 필요한 컬럼만 추출("발생일","발생지_시군구", "사고건수)
ls(crash)
gu_data <- select(crash,"발생일","발생지_시군구", "사고건수)
head(gu_data)
gu_data <- select(crash,"발생일","발생지_시군구", "사고건수")
head(gu_data)
View(gu_data)
ls(crash)
gu_data <- select(crash,"발생일","발생지_시군구", "사고건수")
head(gu_data)
View(gu_data)
write.csv(gu_data,file="gu_data.csv")
gu_data_group <- gu_data %>%
group_by(발생일) %>%
group_by(발생지_시군구)
View(gu_data_group)
gu_data_group <- gu_data %>% group_by("발생지_시군구") %>% summarise(발생일 = sum(발생일))
gu_data_group <- gu_data %>% group_by("발생지_시군구") %>% summarise(발생일= max(발생일))
View(gu_data_group)
gu_data_group <- gu_data %>% group_by("발생지_시군구") %>% summarise(사고건수=sum(사고건수))
View(gu_data_group)
ls(crash)
data_gu <- select(crash,"발생일","발생지_시군구", "사고건수")
head(data_gu)
View(data_gu)
write.csv(data_gu,file="data_gu.csv")
# 파생변수 만들기
data_gu_num %>% summarize(data_gu = n_distinct(발생지_시군구))
data_gu_num %>% summarize(data_gu = n_distinct(발생지_시군구))
data_gu_num %>% summarize(data_gu = n_distinct("발생지_시군구"))
data_gu_num %>%
group_by(발생지_시군구)
summarise(사고건수 = sum(사고건수))
ls(crash)
data_gu <- select(crash,"발생일","발생지_시군구", "사고건수")
head(data_gu)
View(data_gu)
write.csv(data_gu,file="data_gu.csv")
data_gu_num %>%
group_by(발생지_시군구)
summarise(사고건수 = sum(사고건수))
data_gu %>%
group_by(발생지_시군구)
summarise(사고건수 = sum(사고건수))
data_gu %>%
group_by(발생지_시군구)
summarise(사고건수 = sum(사고건수))
data_gu_sum <- data_gu %>%
group_by(발생지_시군구)
summarise(사고건수 = sum(사고건수))
View(data_gu_sum)
data_gu_sum <- data_gu %>%
group_by(발생지_시군구)
summarise(사고건수_sum = sum(사고건수))
library(foreign)
library(ggplot2)
#install.packages('dplyr')
library(dplyr) # 데이터 처리를 위한 R 패키지로 데이터추출, 변수 선택, 변수 추가, 정렬, 결과 요약과 같은 데이터 분석을 위한 사전처리 작업을 보다 쉽게 할 수 있는 기능 제공
# install.packages("descr")
library(descr)
.libPaths() # : 패키지 경로 확인
library(googleVis)
library(reshape2)
library(ggplot2)
library(MASS)
# install.packages('tidyverse')
library('tidyverse')
# install.packages('lubridate')
library('lubridate')
# library(readxl)
library(psych)
library(readxl)
library(scales)
data_gu_sum <- data_gu %>%
group_by(발생지_시군구)
summarise(사고건수_sum = sum(사고건수))
View(data_gu_sum)
ggplot(dura_sunshine_group,aes(x=group,y=사고건수사고건수_평균,group=1
))+
+ ylim(30,200)
+ geom_line()
+ ggtitle("17~19년도 일조량에 따른 사고건수")
data_gu_sum <- data_gu %>%
group_by(발생지_시군구)
summarise(사고건수_sum = sum(사고건수))
View(data_gu_sum)
data_gu_gu <- data_gu %>% select(발생지_시군구)
head(data_gu_gu)
View(data_gu_gu)
data_gu_sum <- data_gu %>%
group_by(발생지_시군구)
summarise(사고건수_합 = sum(사고건수))
View(data_gu_sum)
ggplot(data_gu_sum,aes(x=발생지_시군구,y=사고건수_합,fill=as.factor(사고건수_합))) + geom_col()
data_gu_sum <- data_gu %>%
group_by(발생지_시군구)
summarise(사고건수_합 = sum(사고건수))
ls(crash)
data_gu <- select(crash,"발생일","발생지_시군구", "사고건수")
head(data_gu)
View(data_gu)
data_gu_sum <- data_gu %>%
group_by(발생지_시군구)
summarise(사고건수_합 = sum(사고건수))
View(data_gu_sum)
View(data_gu)
data_gu_sum <- data_gu %>%
group_by(발생지_시군구)
summarise(사고건수_합 = sum(사고건수))
data_gu_sum <- data_gu %>%
group_by(발생지_시군구) %>%
summarise(시군구별_사고건수_합 = sum(사고건수))
View(data_gu_sum)
ggplot(data_gu_sum,aes(x=발생지_시군구,y=사고건수_합,fill=as.factor(사고건수_합))) + geom_col()
ggplot(data_gu_sum,aes(x=발생지_시군구,y=시군구별_사고건수_합,fill=as.factor(사고건수_합))) + geom_col()
ggplot(data_gu_sum,aes(x=발생지_시군구,y=사고건수_합,fill=as.factor(시군구별_사고건수_합))) + geom_col()
ggplot(data_gu_sum,aes(x=발생지_시군구,y=시군구별_사고건수_합,fill=as.factor(시군구별_사고건수_합))) + geom_col()
ggplot(data_gu_sum,aes(x=시군구별_사고건수_합,y=발생지_시군구,fill=as.factor(시군구별_사고건수_합))) + geom_col()
ggplot(data_gu_sum,aes(x=시군구별_사고건수_합,y=발생지_시군구,fill=시군구별_사고건수_합))) + geom_col()
ggplot(data_gu_sum,aes(x=시군구별_사고건수_합,y=발생지_시군구,fill=시군구별_사고건수_합)) + geom_col()
install.packages('ggmap')
install.packages('raster')
install.packages('rgeos')
install.packages('maptools')
install.packages('rgdal')
library()
# df<-df %>% filter(!is.na(score)) : score 결측치 제거
# aggregate(계산될 열~기준될 열, 데이터, 함수)
# mutate() : %>% (체인 연산자)와 새로운 파생 컬럼을 만드는 함수
#########################################################
#install.packages('dplyr')
#install.packages('ggmap')
#install.packages('raster')
#install.packages('rgeos')
#install.packages('maptools')
#install.packages('rgdal')
library(ggmap)
library(raster)
library(rgeos)
library(maptools)
library(rgdal)
library(foreign)
new_map <- fortify(map,region = 'SIG_GD')
View(new_map)
seoul <- shaplefile("TLSCOO_CTPRVN.shp")
seoul <- shapefile("TLSCOO_CTPRVN.shp")
gu <- names(data_gu)
gu <- names(data_gu)
gu
data_gu_sum <- names(data_gu)
register_google(key='AIzaSyCdF_Ck_BmLU3kDX_3mHbBtyMnRrVx8mNA')
gu_geo <- geocode(data_gu_sum)
data_gu_sum_map <- get_googlemap("서울시",zoom=11,maptype='roadmap')
ggmap(data_gu_sum_map) + geom_point(data=data_gu_sum,
aes(x=lon,
y=lat,
size=findust,
color=findust))+
theme(legend.position = 'none') +
scale_color_gradient(low="blue",high="red")
library(ggiraphExtra)
View(data_gu_sum)
data_gu_sum <- data_gu %>%
group_by(발생지_시군구) %>%
summarise(시군구별_사고건수_합 = sum(사고건수))
View(data_gu_sum)
ggplot(data_gu_sum,aes(x=시군구별_사고건수_합,y=발생지_시군구,fill=시군구별_사고건수_합)) + geom_col()
data_gu_group <- data_gu %>%
group_by(발생지_시군구) %>%
summarise(시군구별_사고건수_합 = sum(사고건수))
View(data_gu_group)
ggplot(data_gu_group,aes(x=시군구별_사고건수_합,y=발생지_시군구,fill=시군구별_사고건수_합)) + geom_col()
data_gu_sum <- sum(data_gu$사고건수)
View(data_gu_sum)
seoul_map <- read_excel('서울_map.xlsx')
names(seoul_map)
View(head(seoul_map))
# 서울시 각 자치구 : name
seoul_map_1 <- seoul_map %>% select(code,name) # 필요한 데이터만 추출하는 과정
head(seoul_map_1)
seoul_code <- seoul_map_1[!duplicated(seoul_map_1$name),]
View(seoul_code)
seoul_code <- seoul_map_1[!duplicated(seoul_map_1$name),]
View(seoul_code)
seoul_code <- rename(seoul_code,area=name)
gu_data_gg <- left_join(data_gu_group, seoul_code, id='발생지_시군구')
ggplot(dura_sunshine_group, aes(x=group, y=사고건수_평균,group=1
))+
geom_line(aes(color="blue"))+
theme(axis.line.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()) +
theme(legend.position = "bottom")
data_shine$일조시간 <- ifelse(data_shine$일조시간 <= 1,'1',
ifelse(data_shine$일조시간 <= 2,'2',
ifelse(data_shine$일조시간 <= 3,'3',
ifelse(data_shine$일조시간 <= 4,'4',
ifelse(data_shine$일조시간 <= 5,'5',
ifelse(data_shine$일조시간 <= 6,'6',
ifelse(data_shine$일조시간 <= 7,'7',
ifelse(data_shine$일조시간 <= 8,'8',
ifelse(data_shine$일조시간 <= 9,'9',
ifelse(data_shine$일조시간 <= 10,'10',
ifelse(data_shine$일조시간 <= 11,'11',
ifelse(data_shine$일조시간 <= 12,'12',
ifelse(data_shine$일조시간 <= 13,'13','14이상')))))))))))))
dura_sunshine_group <- data_shine %>%
group_by(일조시간) %>%
summarise(사고건수_평균 = mean(사고건수))
View(dura_sunshine_group)
ggplot(dura_sunshine_group, aes(x=group, y=사고건수_평균,group=1
))+
geom_line(aes(color="blue"))+
theme(axis.line.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()) +
theme(legend.position = "bottom")
ggplot(dura_sunshine_group, aes(x=group, y=사고건수_평균,group=1
))+
geom_line(aes(color="blue"))+
theme(axis.line.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()) +
theme(legend.position = "bottom")
data_shine$group <- ifelse(data_shine$일조시간 <= 1,'1',
ifelse(data_shine$일조시간 <= 2,'2',
ifelse(data_shine$일조시간 <= 3,'3',
ifelse(data_shine$일조시간 <= 4,'4',
ifelse(data_shine$일조시간 <= 5,'5',
ifelse(data_shine$일조시간 <= 6,'6',
ifelse(data_shine$일조시간 <= 7,'7',
ifelse(data_shine$일조시간 <= 8,'8',
ifelse(data_shine$일조시간 <= 9,'9',
ifelse(data_shine$일조시간 <= 10,'10',
ifelse(data_shine$일조시간 <= 11,'11',
ifelse(data_shine$일조시간 <= 12,'12',
ifelse(data_shine$일조시간 <= 13,'13','14이상')))))))))))))
dura_sunshine_group <- data_shine %>%
group_by(group) %>%
summarise(사고건수_평균 = mean(사고건수))
summary(dura_sunshine_group)
dura_sunshine_group$group <- factor(dura_sunshine_group$group,levels=c('1','2','3','4','5','6','7','8','9','10','11','12','13','14이상'))
View(dura_sunshine_group)
class(dura_sunshine_group)
ggplot(dura_sunshine_group, aes(x=group, y=사고건수_평균,group=1
))+
geom_line(aes(color="blue"))+
theme(axis.line.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()) +
theme(legend.position = "bottom")
=사고건수_평균,group=1
))+
geom_line(aes(color=Tree))+
theme(axis.line.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()) +
theme(legend.position = "bottom")
ggplot(dura_sunshine_group, aes(x=group, y=사고건수_평균,group=1
))+
geom_line(aes(color="red"))+
theme(axis.line.x = element_blank(),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()) +
theme(legend.position = "bottom")
library(ggplot2)
mpg <- as.data.frame(ggplot2::mpg)
View(mpg)
head(mpg)
#mpg data의 관측치와 변수의 수(크기)를 한번에 확인
dim(mpg)
str(mpg)
summary(mpg)
head(new_mpg,3)
new_mpg <- rename(mpg, city=cyt, highway=hwp)
head(new_mpg,3)
# Length:234         Min.   : 9.00   Min.   :12.00
# Class :character   1st Qu.:14.00   1st Qu.:18.00
# Mode  :character   Median :17.00   Median :24.00
# Mean   :16.86   Mean   :23.44
# 3rd Qu.:19.00   3rd Qu.:27.00
# Max.   :35.00   Max.   :44.00
# fl               class
# Length:234         Length:234
# Class :character   Class :character
# Mode  :character   Mode  :character
library(dplyr)
new_mpg <- rename(mpg, city=cyt, highway=hwp)
head(new_mpg,3)
head(new_mpg,3)
new_mpg <- rename(mpg, city=cyt, highway=hwy)
head(new_mpg,3)
new_mpg <- rename(mpg, city=cty, highway=hwy)
head(new_mpg,3)
